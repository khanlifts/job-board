<header>
  <h1>{{ appTitle() }}</h1>
  <nav>
    <a routerLink="/jobs">Jobs</a>
    <a routerLink="/jobs/create">Create Job</a>
    <a routerLink="/companies">Companies</a>
  </nav>
</header>

<main>
  <router-outlet></router-outlet>
</main>

<job-search-input
  (searchChanged)="onSearch($event)"
  placeholder="Search your dream job"
></job-search-input>

@if (searchTerm().length > 0) {
  Results for: "{{ searchTerm() }}"
  @let searchResults = jobService.$searchResult | async;
  @if (searchResults) {
    @if (searchResults.length > 0) {
      <job-list
        [jobs]="searchResults"
        [isDeleting]="jobService.deleting()"
        (deleteJob)="onJobDeleted($event)"
      ></job-list>
    } @else {
      <p>No Jobs found for "{{ searchTerm() }}"</p>
    }
  }
} @else {
  All Jobs

  @if (jobService.loading()) {
    <p>Loading Jobs...</p>
  }

  @if (jobService.error()) {
    <p>Error loading jobs: {{ jobService.error() }}</p>
  }

  @if (!jobService.loading() && jobService.jobs().length > 0) {
    <job-list
      [jobs]="jobService.jobs()"
      [isDeleting]="jobService.deleting()"
      (deleteJob)="onJobDeleted($event)"
    ></job-list>
  }

  @if (!jobService.loading() && jobService.jobs().length === 0) {
    <p>No Jobs available</p>
  }
}

<app-job-posting-form (jobSubmitted)="onJobSubmitted($event)"></app-job-posting-form>

@if (jobService.creatingJobs()) {
  <p>Creating Job...</p>
}

<job-stats
  [selectedIndustry]="selectedIndustry()"
  [statsFoundJobString]="statsFoundJobsString()"
></job-stats>

@if (jobService.deleting()) {
  <p>Deleting Jobs...</p>
}

<h3>Companies:</h3>

@if (companyService.loading()) {
  <p>Loading Companies...</p>
}

@if (companyService.error()) {
  <p>Error Loading Companies: {{ companyService.error() }}</p>
}

@if (!companyService.loading() && companyService.companies().length > 0) {
  @for (company of companiesSignal(); track $index) {
    <company-card
      [companyName]="company.companyName"
      [industry]="company.industry"
      [employeeCount]="company.employeeCount"
    ></company-card>
  }
}

@if (!companyService.loading() && companyService.companies().length === 0) {
  <p>No Companies available</p>
}
